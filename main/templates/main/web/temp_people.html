{% extends 'main/web/base.html' %}


{% block body %}
    <div class="border">
    <h1>인원 추가 페이지</h1>
    </div>
    <div class="container-sm" style="width:35%;height:80%;border:1px solid blue;text-align: center">
    <br><br><br>
        <div class="container">
            <div class="d-flex align-items-center mb-2 mt-2">
                <input
                    type="text"
                    class="form-control"
                    id="name-input"
                    placeholder="Enter the name here"
                />  
                <button type="button" id="add" class="btn btn-primary ms-1 text-nowrap">
                    <i class="bi bi-plus"></i> Add
                </button>
            </div>
        </div>
        <div id="peopleList" style="width:100%;height:80%;border:1px solid blue;text-align: center">
            <div class="people p-1 rounded-2 ps-2 d-flex align-items-center">
                
            </div>
        </div>
        <div>
            <button onclick="location.href='{% url 'main:temp_calculate' %}'">다음</button>   
        </div>
    <br><br><br><br><br><br>  
    </div>
    
    <br>
    <br>
    
    <script
      src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.0-beta3/dist/js/bootstrap.bundle.min.js"
      integrity="sha384-JEW9xMcG8R+pH31jmWH6WWP0WintQrMb4s7ZOdauHnUtxwoG2vI5DkLtS3qm9Ekf"
      crossorigin="anonymous"
    ></script>
    
    <script>
        const Type = {
            Name: 1
        };
        let people = [];

        
        function loadPeople() {
            let lastPeople = localStorage.getItem("people");
            if (!lastPeople) return;
            
            people = JSON.parse(lastPeople);
            people.forEach(addToList);
        }
        
        function savePeople() {
            localStorage.setItem("people", JSON.stringify(people));
        }
        
        function addToList(person) {
            let div = document.createElement("div");
            div.className = "people p-1 rounded-2 ps-2 d-flex align-items-center";
            
            let span = document.createElement("span");
            span.className = "me-auto";
            span.textContent = person.text;
            div.appendChild(span);
            
            let buttonRemove = document.createElement("button");
            buttonRemove.className = "btn btn-sm btn-danger";
            buttonRemove.innerHTML = '<i class="bi bi-x"></i>';
            div.appendChild(buttonRemove);
            
            buttonRemove.addEventListener("click", () => {
                div.remove();
                people = people.filter((t) => t !== person);
                savePeople();
            });
            
            
            
            let list = document.querySelector("#peopleList");
            list.appendChild(div);
        }
        
        
        window.addEventListener("load", () => {
            loadPeople();
        });
        
        let button = document.querySelector("#add");
        button.addEventListener("click", () => {
            let input = document.querySelector("#name-input");
            let text = input.value;
            
            if (!text.length) return;
            
            let person = {
                text: text,
                type: Type.Name,
            };
            
            people.push(person);
            savePeople();
            
            addToList(person);
            
            input.value="";
        });
    </script>    
{% endblock %}